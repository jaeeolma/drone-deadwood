---

title: Models


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/06_models.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_models.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mask_rcnn_custom_anchors" class="doc_header"><code>mask_rcnn_custom_anchors</code><a href="https://github.com/jaeeolma/drone_detector/tree/master/drone_detector/models.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mask_rcnn_custom_anchors</code>(<strong><code>num_classes</code></strong>:<code>int</code>, <strong><code>backbone</code></strong>=<em><code>None</code></em>, <strong><code>pretrained</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sizes</code></strong>:<code>tuple</code>=<em><code>((32,), (64,), (128,), (256,), (512,))</code></em>, <strong><code>aspect_ratios</code></strong>:<code>tuple</code>=<em><code>(0.5, 1.0, 2.0)</code></em>)</p>
</blockquote>
<p>Make icevision Mask RCNN with custom anchors. Default values are torchvision defaults</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="faster_rcnn_custom_anchors" class="doc_header"><code>faster_rcnn_custom_anchors</code><a href="https://github.com/jaeeolma/drone_detector/tree/master/drone_detector/models.py#L58" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>faster_rcnn_custom_anchors</code>(<strong><code>num_classes</code></strong>:<code>int</code>, <strong><code>backbone</code></strong>=<em><code>None</code></em>, <strong><code>pretrained</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sizes</code></strong>:<code>tuple</code>=<em><code>((32,), (64,), (128,), (256,), (512,))</code></em>, <strong><code>aspect_ratios</code></strong>:<code>tuple</code>=<em><code>(0.5, 1.0, 2.0)</code></em>)</p>
</blockquote>
<p>Make icevision Faster RCNN with custom anchors. Default values are torchvision defaults</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to easily load custom model configurations, save the required information to a config json-file. The file has a format of</p>
<ul>
<li><code>model_type</code>: either <code>'mask_rcnn'</code> or <code>'faster_rcnn'</code></li>
<li><code>backbone_name</code>: name of the torchvision model used as backbone, e.g. <code>'resnext101_32x8d_fpn'</code></li>
<li><code>anchor_generator_sizes</code>: List of the anchor sizes, e.g. <code>[32,64,128,256,512]</code> is the default</li>
<li><code>aspect_ratios</code>: List of the used aspect ratios for anchors, e.g. <code>[0.5, 1, 2]</code> is the default</li>
<li><code>categories</code>: COCO-style dict of categories the model is trained on</li>
<li><code>model_fname</code>: filename for the trained weights</li>
</ul>
<p>Both <code>model.pth</code> and <code>config.json</code> are saved in the same folder.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="save_model_and_config" class="doc_header"><code>save_model_and_config</code><a href="https://github.com/jaeeolma/drone_detector/tree/master/drone_detector/models.py#L93" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>save_model_and_config</code>(<strong><code>outdir</code></strong>, <strong><code>model</code></strong>, <strong><code>backbone_name</code></strong>, <strong><code>model_type</code></strong>, <strong><code>categories</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_rcnn_from_config" class="doc_header"><code>load_rcnn_from_config</code><a href="https://github.com/jaeeolma/drone_detector/tree/master/drone_detector/models.py#L118" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_rcnn_from_config</code>(<strong><code>path_to_conf</code></strong>)</p>
</blockquote>
<p>Load model according to config</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

